<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui">
<f:view>
	<h:head>

		<title>#{Gestionfacturas.titulo}</title>
		<link rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
		<script
			src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

	</h:head>

	<body
		style="font-family: verdana, arial; margin: 0px; margin-top: 0px; background-color: #edf6f9; font-weight: bold;">
		<h:form id="documento" style="background-color: #edf6f9; width: 100%;">

			<div
				style="width: 100%; background-color: #a3cef1; height: 30px; display: flex; align-items: center; justify-content: space-between;">
				<h:outputText style="float: left; margin-left: 20px;"
					value="¡Bienvenido, #{usuario.coUsuarios} !"
					rendered="#{not empty usuario}" />
				<div style="display: flex; align-items: center;">
					<h:commandLink
						id="administrarUsuarios"
						rendered="#{Gestionusuarios.objetoSeleccionado.boAdmin eq 1}"
						style="color: #000; float: right; margin-right: 20px; font-size: 12px; text-decoration: none; padding: 3px;"
						onmouseover="this.style.color='#000'; this.style.backgroundColor='#6096ba'; this.style.transform='scale(1.05)'; this.style.borderRadius='15px';"
						onmouseout="this.style.color='#000';  this.style.transform='scale(1)'; this.style.backgroundColor='transparent'; this.style.borderRadius='none';"
						value="Administrar usuarios"
						action="#{Gestionusuarios.administrar()}" />
					<h:commandLink style="float: right; margin-right: 20px;"
						action="#{Gestionusuarios.perfil()}" update="documento">
						<img src="usuario.png" alt="Perfil de usuario"
							style="width: 25px; height: 25px; transition: background-color 0.3s; border-radius: 50%; padding: 2px;"
							onmouseover="this.style.backgroundColor='#6096ba';"
							onmouseout="this.style.backgroundColor='transparent';"> 
						</img>
					</h:commandLink>
					<h:commandLink style="float: right; margin-right: 20px;"
						action="#{Gestionusuarios.cerrarSesion()}" update="documento">
						<img src="salir.png" alt="Cerrar Sesión"
							style="width: 25px; height: 25px; transition: background-color 0.3s; border-radius: 50%; margin: 5px;"
							onmouseover="this.style.backgroundColor='#6096ba';"
							onmouseout="this.style.backgroundColor='transparent';"> 
						</img>
					</h:commandLink>
				</div>
			</div>
			<div
				style="background-color: #003049; color: #FFFFFF; text-align: center; padding: 10px;">
				<h1>Gestión de Facturas</h1>
			</div>

			<div style="display: flex; justify-content: center; margin: 10px;">
				<h:commandButton
					style=" text-aling:center ;width: 200px; height: 30px; border-radius: 15px;  
					background-color: #a3cef1; border: none; color: black; font-size: 16px;
					 font-weight: bold; margin-right: 10px; text-transform: uppercase; box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.3);"
					onmouseover="this.style.backgroundColor='#6096ba'; this.style.color='#ffff'; this.style.transform='scale(1.05)'; this.style.fontSize='17px';"
					onmouseout="this.style.backgroundColor='#a3cef1'; this.style.color='#000'; this.style.transform='scale(1)'; this.style.fontSize='16px';"
					value="Nueva factura +" action="#{Gestionfacturas.darDeAlta()}">
				</h:commandButton>
				<h:commandButton
					style=" text-aling:center ;width: 200px; height: 30px; border-radius: 15px;  
					background-color: #a3cef1; border: none; color: black; font-size: 16px; font-weight: bold;
					 margin-right: 10px; text-transform: uppercase; box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.3);"
					onmouseover="this.style.backgroundColor='#6096ba'; this.style.color='#ffff'; this.style.transform='scale(1.05)'; this.style.fontSize='17px';"
					onmouseout="this.style.backgroundColor='#a3cef1'; this.style.color='#000'; this.style.transform='scale(1)'; this.style.fontSize='16px';"
					value="Filtro de Pagos" action="#{Gestionfacturas.filtroPagos()}">

				</h:commandButton>
			</div>

			<table style="border-spacing: 0px; width: 100%;">
				<tr style="background-color: #a3cef1; padding: 5px;">
					<td style="text-align: right;"><label for="codigoFactura">
							Código Factura: </label></td>
					<td style="float: left; padding: 5px"><h:inputText
							style="width: 300px; padding: 5px; border: 1px solid #232D3F; border-radius: 5px;"
							id="codigoFactura" value="#{Gestionfacturas.coFacturas}">
						</h:inputText></td>
				</tr>
				<tr style="background-color: #6096ba; padding: 5px;">
					<td style="text-align: right;"><label for="descripcionFactura">
							Descripción Factura: </label></td>
					<td style="float: left; padding: 5px"><h:inputText
							style="width: 300px; padding: 5px; border: 1px solid #232D3F; border-radius: 5px;"
							id="descripcionFactura" value="#{Gestionfacturas.dsFacturas}">
						</h:inputText></td>
				</tr>
				<tr style="background-color: #a3cef1; padding: 5px;">
					<td style="text-align: right;"><label for="fechaFactura">
							Fecha Factura: </label></td>
					<td style="float: left; padding: 5px"><h:inputText
							style="width: 300px; padding: 5px; border: 1px solid #232D3F; border-radius: 5px;"
							id="fechaFactura" value="#{Gestionfacturas.feFacturasStr}">
						</h:inputText></td>
				</tr>
				<tr style="background-color: #6096ba; padding: 5px;">
					<td style="text-align: right;"><label for="importeFactura">
							Importe desde: </label></td>
					<td style="float: left; padding: 5px"><h:inputText
							style="width: 300px; padding: 5px; border: 1px solid #232D3F; border-radius: 5px;"
							id="importeFactura" value="#{Gestionfacturas.imFacturas}">
						</h:inputText></td>
				</tr>
				<tr style="background-color: #a3cef1; padding: 5px;">
					<td style="text-align: right;"><label for="importeFactura">
							Importe hasta: </label></td>
					<td style="float: left; padding: 5px;"><h:inputText
							style="width: 300px; padding: 5px; border: 1px solid #232D3F; border-radius: 5px;"
							id="importeFacturaHasta"
							value="#{Gestionfacturas.imFacturasHasta}">
						</h:inputText></td>
				</tr>
				<tr style="background-color: #6096ba; padding: 5px;">
					<td style="text-align: right;"><label
						style="margin-left: 10px;" for="tipoImpuesto"> Tipo de
							impuesto: </label></td>
					<td style="float: left; padding: 5px;"><h:selectOneMenu
							id="tipoImpuesto" value="#{Gestionfacturas.idImpuesto}"
							style="width: 313px; padding: 5px; border: 1px solid #232D3F; border-radius: 5px;">
							<f:selectItem itemLabel="Selecione el tipo de impuesto"
								itemValue="" />

							<f:selectItems value="#{Gestionfacturas.obtenerTiposImpuesto()}"
								var="tipoImpuesto" itemValue="#{tipoImpuesto.idImpuesto}"
								itemLabel="#{tipoImpuesto.coImpuesto} - #{tipoImpuesto.dsImpuesto} - #{tipoImpuesto.pjImpuesto.intValue()}%" />
						</h:selectOneMenu></td>
				</tr>
				<tr style="background-color: #a3cef1; padding: 5px;">
					<td style="text-align: right;"><label
						style="margin-left: 10px;" for="baseImponible"> Base
							Imponible: </label></td>
					<td style="float: left; padding: 5px;"><h:inputText
							style="width: 300px; padding: 5px; border: 1px solid #232D3F; border-radius: 5px;"
							id="baseImponible" value="#{Gestionfacturas.imBaseImponible}">
						</h:inputText></td>
				</tr>
			</table>

			<div style="display: flex; justify-content: center; margin: 10px;">
				<h:commandButton id="limpiar"
					style="width: 200px; height: 30px; border-radius: 15px; 
						background-color: #ffc300; border: none; color: black; 
						font-size: 16px; font-weight: bold; 
						text-transform: uppercase; margin-right: 10px; box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.3);"
					onmouseover="this.style.backgroundColor='#ffd60a'; this.style.color='#ffff'; this.style.transform='scale(1.05)'; this.style.fontSize='17px';"
					onmouseout="this.style.backgroundColor='#ffc300'; this.style.color='black'; this.style.transform='scale(1)'; this.style.fontSize='16px';"
					value="Limpiar" action="#{Gestionfacturas.limpiar()}">
				</h:commandButton>
				<h:commandButton id="filtrarFactura"
					style="width: 200px; height: 30px; border-radius: 15px; 
					background-color: #57cc99; border: none; color: black; 
						font-size: 16px; font-weight: bold;  
						text-transform: uppercase; box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.3);"
					onmouseover="this.style.backgroundColor='#80ed99';this.style.color='#ffff'; this.style.transform='scale(1.05)'; this.style.fontSize='17px';"
					onmouseout="this.style.backgroundColor='#57cc99'; this.style.color='black'; this.style.transform='scale(1)'; this.style.fontSize='16px';"
					value="Filtrar Factura" action="#{Gestionfacturas.buscar()}">
				</h:commandButton>
				
			</div>

			<div style="display: flex; justify-content: center; width: 100%;">
				<table
					style="border-collapse: collapse; width: 80%; background-color: #FFF6E9;">
					<thead>
						<tr
							style="background-color: #a3cef1; border-bottom: 1px solid #232D3F; border-top: 1px solid #232D3F;">
							<th
								style="padding: 15px; text-align: center; border-right: 1px solid #232D3F; border-left: 1px solid #232D3F;">
								Código</th>
							<th
								style="padding: 15px; text-align: center; border-right: 1px solid #232D3F;">
								Descripción</th>
							<th
								style="padding: 15px; text-align: center; border-right: 1px solid #232D3F;">
								Fecha</th>
							<th
								style="padding: 15px; text-align: center; border-right: 1px solid #232D3F;">
								Importe</th>
							<th
								style="padding: 15px; text-align: center; border-right: 1px solid #232D3F;">
								Tipo de impuesto</th>
							<th
								style="padding: 15px; text-align: center; border-right: 1px solid #232D3F;">
								Base Imponible</th>
							<th
								style="padding: 15px; text-align: center; border-right: 1px solid #232D3F;">
								Pagado</th>
						</tr>
					</thead>

					<tbody>
						<c:forEach items="#{Gestionfacturas.listaResultados}" var="item"
							varStatus="loop">
							<tr
								style="border-bottom: 1px solid #232D3F; background-color: #{loop.index % 2 == 0 ? '#FBF9F1' : '#FFFFFF'};"
								onmouseover="this.style.backgroundColor='#ffbf81';"
								onmouseout="this.style.backgroundColor='#{loop.index % 2 == 0 ? '#FBF9F1' : '#FFFFFF'}';">
								<td
									style="padding: 15px; text-align: center; border-right: 1px solid #232D3F; border-left: 1px solid #232D3F;">
									<h:commandLink value="#{item.coFacturas}" process="@this"
										action="#{Gestionfacturas.detalleFactura()}" type="submit">
										<f:setPropertyActionListener
											target="#{Gestionfacturas.objetoSeleccionado}"
											value="#{item}" />
									</h:commandLink>
								</td>
								<td
									style="padding: 15px; text-align: center; border-right: 1px solid #232D3F;">
									#{item.dsFacturas}</td>
								<td
									style="padding: 15px; text-align: center; border-right: 1px solid #232D3F;">
									<h:outputText value="#{item.feFacturasStr}">
										<f:convertDateTime pattern="dd/MM/yyyy" />
									</h:outputText>
								</td>
								<td
									style="padding: 15px; text-align: center; border-right: 1px solid #232D3F;">
									#{item.imFacturas} €</td>
								<td
									style="padding: 15px; text-align: center; border-right: 1px solid #232D3F;">
									#{item.coImpuesto}</td>
								<td
									style="padding: 15px; text-align: center; border-right: 1px solid #232D3F;">
									#{item.imBaseImponible} €</td>
								<td
									style="padding: 15px; text-align: center; border-right: 1px solid #232D3F;">
									<c:choose>
										<c:when test="#{item.idPagos == null || item.idPagos == 0}">
											<img style="width: 15px; height: 15px;" src="cerrar.png"
												alt="No pagado" />
										</c:when>
										<c:otherwise>
											<img style="width: 15px; height: 15px;" src="chek.png"
												alt="Pagado" />
										</c:otherwise>
									</c:choose>
								</td>
							</tr>
						</c:forEach>
					</tbody>
				</table>
			</div>
		</h:form>
		<br></br>
	</body>
</f:view>
</html>